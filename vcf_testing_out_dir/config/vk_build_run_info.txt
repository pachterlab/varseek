Time of execution: 2025-03-06 16:06:14

varseek version: 0.1.0

def test_vcf(vcf_file_and_corresponding_sequences, out_dir):
    vcf_file_path, sequences_fasta_path = vcf_file_and_corresponding_sequences

    result = vk.build(
        variants="vcf_testing.vcf",
        sequences="sequences_testing.fa",
        out="vcf_testing_out_dir",
        seq_id_column="chromosome",
        var_column="mutation_from_vcf",
        overwrite=True
    )
    
    result = vk.build(
        sequences=long_sequence,
        optimize_flanking_regions = True,
        variants="c.35G>A",
        return_variant_output=True,
        required_insertion_overlap_length=None,
        w=30,
        k=31,
        out=out_dir
    )

    assert result[0] == "GCCCCACCCCGCCCCTCCCCGCCCCACCCCACCCCTCCCCGCCCCACCCCGCCCCTCCCCG"

    assert_global_variables_zero()
